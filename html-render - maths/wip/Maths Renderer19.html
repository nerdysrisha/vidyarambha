<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Math Panel</title>
<!--
Maths Renderer - V19
Have the question panel to be fixed size. 
-->
<style>
html,body{
    margin:0;
    height:100%;
    background:black;
    color:white;
    font-family:Arial, sans-serif;
}
#outer{
    margin:20px;
    height: calc(100vh - 40px); /* Full viewport minus margins */
    display:flex;
    flex-direction:column;
    gap:20px;
    overflow: hidden; /* Prevent outer scrolling */
}

/* CONTROL PANEL */
#control{
    position:sticky;
    top:0;
    z-index:10;
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap:10px 16px;
    background:black;
    border:1px solid #444;
    padding:16px;
}

#control legend{
    padding:0 10px;
    font-size:16px;
    color:#aaa;
}

/* checkbox items inside control panel */
.ctrl-item{
    display:flex;
    align-items:center;
    gap:8px;
    white-space:nowrap;
}

/* QUESTIONS PANEL */
 

#questions {
    display: flex;
    flex-direction: column;
    gap: 20px;
    border: 1px solid #444;
    padding: 12px;
    flex: 1; /* Take remaining space */
    overflow-y: auto; /* Scroll inside this panel */
    min-height: 0; /* Important for flex scrolling */
}

#questions legend{
    padding:0 10px;
    font-size:16px;
    color:#aaa;
}

/* STACK WRAPPER - contains the two boxes side by side */
.stack-wrapper {
    width: 100%;
    display: grid;
    grid-template-columns: 3fr 1fr;
    gap: 12px;
    min-height: 400px; /* Increased from 260px */
    align-items: stretch;
}

/* INDIVIDUAL BOXES */
.stack-box{
    border:1px solid #222;
    background:#111;
    padding:12px;
    box-sizing:border-box;
    display:flex;           /* add this */
    flex-direction: column; /* add this */
    height: 100%;           /* add this */
}

/* QUESTIONS BOX (left) */
.questions-box{
    /* larger box for questions only */
}

/* ANSWERS BOX (right) */
.answers-box{
    display: flex;
    flex-direction: column;
    justify-content: center; /* Vertically center from top to bottom */
}

/* HEADINGS */
.problem-title.inline-title {
    color: #28a745;
    font-weight:bold;
    margin-bottom:8px;
    font-size:24px;
}

.problem-title.github-title {
    color: #ff9900;
    font-weight:bold;
    margin-bottom:8px;
    font-size:24px;
}

/* QUESTION ROWS (left box) */
.question-row{
    display:flex;
    gap:8px;
    font-size:40px;
    line-height:2;
    padding-left:40px;
    box-sizing:border-box;
}

/* ANSWER ROWS (right box) */
.answer-row{
    display:flex;
    flex-direction:column;
    gap:12px;
    font-size:40px;
    line-height:2;
    padding-left:20px;
}

.answer-item {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 20px; /* vertical spacing */
    font-size: 40px;
}


.answer-item .answer-letter {
    width: 40px;       /* fixed width for the letter */
    text-align: right; /* align letter to the right */
    margin-right: 12px; /* space between letter and input */
    color: #28a745;
    font-weight: bold;
    flex-shrink: 0;    /* prevent shrinking */
}


/* ANSWERS */
.answer{
    visibility:hidden;
    color:#58D68D;
    font-weight:bold;
}
.answer.show{
    visibility:visible;
}

/* BUTTONS */
button{
    padding:6px 12px;
    border:none;
    cursor:pointer;
    background:#58D68D;
    color:black;
}

.answer-input{
    width:90px;
    height:22px;
    background:#000;
    color:#fff;
    border:1px solid #444;
    text-align:center;
    font-size:14px;
}

/* Dark scrollbar for the main questions panel */
#questions::-webkit-scrollbar {
    width: 12px;
}

#questions::-webkit-scrollbar-track {
    background: #111;
}

#questions::-webkit-scrollbar-thumb {
    background-color: #555;
    border-radius: 6px;
    border: 3px solid #111;
}

#questions::-webkit-scrollbar-thumb:hover {
    background-color: #888;
}

</style>
</head>
<body>
<div id="outer">
    <fieldset id="control">
        <legend>Control Panel</legend>
        <button id="toggleAll">Show</button>
    </fieldset>

    <fieldset id="questions">
        <legend>Questions Panel</legend>
    </fieldset>
</div>

<script>
const BASE_URL="https://raw.githubusercontent.com/nerdysrisha/vidyarambha/refs/heads/main/maths/questions/";

const options = [
    ["addend-left-missing","1. Missing Left Addend"],
    ["addend-right-missing","2. Missing Right Addend"],
    ["dividend-missing","3. Missing Dividend"],
    ["divisor-missing","4. Missing Divisor"],
    ["factor-left-missing","5. Missing Left Factor"],
    ["factor-right-missing","6. Missing Right Factor"],
    ["minuend-missing","7. Missing Minuend"],
    ["subtrahend-missing","8. Missing Subtrahend"],
    ["generate-additions-2","9. Additions 2 Numbers"],
    ["generate-additions-3","10. Additions 3 Numbers"],
    ["gen-sub-no-borrow","11. Subtraction No Borrow"],
    ["gen-sub-with-borrow","12. Subtraction With Borrow"],
    ["gen-mul-1-digit","13. Multiply 1 Digit"],
    ["gen-mul-2-digit","14. Multiply 2 Digits"],
    ["number-names","15. Number Names"],
    ["basic-multiplications","16. Multiplications"],
    ["basic-additions","17. Additions"],
    ["basic-subtractions","18. Subtractions"],
    ["basic-divisions","19. Divisions"],
    ["ascending","20. Ascending Order"],
    ["descending","21. Descending Order"],
    ["draw-clock","22. Draw Clock"],
    ["tell-time","23. Tell Time"],
    ["bodmas","24. BODMAS"],
    ["pattern-completion","25. Pattern Completion"],
    ["word-problems","26. Word Problems"],
    ["fractions","27. Fractions"],
    ["round-off-numbers","28. Round Off Numbers"],
    ["before-numbers","29. Before Numbers"],
    ["after-numbers","30. After Numbers"],
    ["between-numbers","31. Between Numbers"],
    ["greater-lesser","32. Greater / Lesser"]
];

const control=document.getElementById("control");
const questions=document.getElementById("questions");
const toggleAll=document.getElementById("toggleAll");
let showAll=false;
const stacks={};

function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

options.forEach(([val,label])=>{
    const wrap=document.createElement("label");
    wrap.className="ctrl-item";
    const cb=document.createElement("input");
    cb.type="checkbox";
    cb.onchange=()=>cb.checked?addStack(val):removeStack(val);
    wrap.append(cb,document.createTextNode(label));
    control.appendChild(wrap);
});

toggleAll.onclick=()=>{
    const pwd=prompt("Enter PIN");
    if(pwd!=="0000") return;
    showAll=!showAll;
    document.querySelectorAll(".answer").forEach(a=>a.classList.toggle("show",showAll));
    toggleAll.textContent=showAll?"Hide":"Show";
};

function renderSplitRow(letter, question, answer) {
    return {
        questionHTML: `<div class="question-row">(${letter}) ${question}</div>`,
        answerHTML: `
            <div class="answer-item">
                <span class="answer-letter">(${letter})</span>
                <input type="text" class="answer-input" />
                <span class="answer">${answer}</span>
            </div>
        `
    };
}

function addStack(val){
    if(stacks[val]) return;
    const wrapper=document.createElement("div");
    wrapper.className="stack-wrapper";
    
    const questionsBox=document.createElement("div");
    questionsBox.className="stack-box questions-box";
    
    const answersBox=document.createElement("div");
    answersBox.className="stack-box answers-box";
    
    wrapper.appendChild(questionsBox);
    wrapper.appendChild(answersBox);
    
    stacks[val]=wrapper;
    questions.appendChild(wrapper);
    wrapper.scrollIntoView({behavior:"smooth", block:"end"});
    generate(questionsBox, answersBox, val);
}

function removeStack(val){
    stacks[val]?.remove();
    delete stacks[val];
}

function generate(questionsBox, answersBox, val){
    questionsBox.innerHTML="";
    answersBox.innerHTML="";

    let option = options.find(o => o[0] === val);
    if(option){
        questionsBox.innerHTML = `<div class="problem-title inline-title">${option[1]}</div>`;
    }

    if(val==="generate-additions-2"){
        for(let i=0;i<4;i++){
            let a = rand(100,999), b = rand(100,999);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}+${b}=`, a+b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="generate-additions-3"){
        for(let i=0;i<4;i++){
            let a = rand(100,999), b = rand(100,999), c = rand(100,999);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}+${b}+${c}=`, a+b+c);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="gen-sub-no-borrow"){
        for(let i=0;i<4;i++){
            let a = rand(100,999);
            let aD = String(a).split('').map(Number);
            let bD = String(rand(100,999)).split('').map((d,j)=>Math.min(d,aD[j]));
            let b = parseInt(bD.join(''));
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}-${b}=`, a-b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="gen-sub-with-borrow"){
        for(let i=0;i<4;i++){
            let a = rand(100,999), b = rand(100,999);
            if(b>a)[a,b]=[b,a];
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}-${b}=`, a-b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="gen-mul-1-digit"){
        for(let i=0;i<4;i++){
            let a = rand(10,99), b = rand(1,9);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}×${b}=`, a*b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="gen-mul-2-digit"){
        for(let i=0;i<4;i++){
            let a = rand(10,99), b = rand(10,99);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}×${b}=`, a*b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="number-names"){
        const letters = ["a","b","c","d"];
        [rand(100,999),rand(100,999),rand(1000,9999),rand(1000,9999)]
        .forEach((n,i)=>{
            let row = renderSplitRow(letters[i], `${n}`, n);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        });
    }
    else if(val==="basic-multiplications"){
        for(let i=0;i<4;i++){
            let a = rand(12,19), b = rand(2,9);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}×${b}=`, a*b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="basic-additions"){
        for(let i=0;i<4;i++){
            let a = rand(1,9), b = rand(1,9);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}+${b}=`, a+b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="basic-subtractions"){
        for(let i=0;i<4;i++){
            let a = rand(1,9), b = rand(0,a);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}-${b}=`, a-b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="basic-divisions"){
        for(let i=0;i<4;i++){
            let b = rand(2,9), a = b * rand(2,9);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${a}÷${b}=`, a/b);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="ascending" || val==="descending"){
        for(let i=0; i<2; i++){
            let arr = [...Array(6)].map(() => rand(10,99));
            let letter = String.fromCharCode(97 + i);
            let s = [...arr].sort((a,b)=>val==="ascending"?a-b:b-a);
            let row = renderSplitRow(letter, arr.join(", "), s.join(", "));
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="draw-clock"){
        for(let i=0;i<2;i++){
            let letter = String.fromCharCode(97 + i);
            let time = `${rand(1,12)}:${rand(0,59).toString().padStart(2,"0")}`;
            let row = renderSplitRow(letter, time, "");
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="tell-time"){
        let first = rand(1,68);
        let second;
        do {
            second = rand(1,68);
        } while(second === first);

        const numbers = [first, second];
        const letters = ["a","b"];

        numbers.forEach((n,i) => {
            const imgWrapper = document.createElement("div");
            imgWrapper.style.display = "flex";
            imgWrapper.style.flexDirection = "column";
            imgWrapper.style.alignItems = "center";
            imgWrapper.style.marginBottom = "12px";

            const img = document.createElement("img");
            img.src = `https://raw.githubusercontent.com/nerdysrisha/vidyarambha/main/clocks/clock${n}.png`;
            img.alt = `Clock ${n}`;
            img.style.width = "160px";
            img.style.height = "160px";

            const filename = document.createElement("span");
            filename.textContent = `(${letters[i]}) clock${n}.png`;
            filename.style.fontSize = "14px";
            filename.style.marginTop = "4px";
            filename.style.color = "#aaa";

            imgWrapper.appendChild(img);
            imgWrapper.appendChild(filename);
            questionsBox.appendChild(imgWrapper);

            const answerItem = document.createElement("div");
            answerItem.className = "answer-item";
            answerItem.style.marginBottom = "12px";
            
            const input = document.createElement("input");
            input.type = "text";
            input.className = "answer-input";
            
            const answer = document.createElement("span");
            answer.className = "answer";
            answer.textContent = "";
            
            answerItem.appendChild(input);
            answerItem.appendChild(answer);
            answersBox.appendChild(answerItem);
        });
    }
    else if(val==="round-off-numbers"){
        for(let i=0;i<4;i++){
            let n = rand(11,99);
            let rounded = Math.round(n/10)*10;
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${n}`, rounded);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="before-numbers"){
        for(let i=0;i<4;i++){
            let n = rand(2,99);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `__, ${n}`, n-1);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="after-numbers"){
        for(let i=0;i<4;i++){
            let n = rand(1,98);
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${n}, __`, n+1);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="between-numbers"){
        for(let i=0;i<4;i++){
            let start = rand(10,97);
            let end = start + 2;
            let mid = start + 1;
            let letter = String.fromCharCode(97 + i);
            let row = renderSplitRow(letter, `${start}, __, ${end}`, mid);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;
        }
    }
    else if(val==="greater-lesser"){
        let ops = [">", "<"];
        let counts = {">":2, "<":2};
        let generated = 0;
        let letterCode = 97;

        while(generated < 4){
            let op = ops.find(o => counts[o] > 0);
            if(!op) break;
            counts[op]--;

            let a, b;
            if(op === ">"){ a = rand(100,999); b = rand(100, a-1); }
            else if(op === "<"){ a = rand(100,998); b = rand(a+1, 999); }

            let letter = String.fromCharCode(letterCode++);
            let row = renderSplitRow(letter, `${a} __ ${b}`, op);
            questionsBox.innerHTML += row.questionHTML;
            answersBox.innerHTML += row.answerHTML;

            generated++;
        }
    }
    else{
        // GitHub fetched
        questionsBox.innerHTML = `<div class="problem-title github-title">${option[1]}</div>`;
        
        fetch(BASE_URL + val + ".json")
        .then(r => r.json())
        .then(d => {
            const idx = [...Array(d.questions.length).keys()]
                            .sort(() => 0.5 - Math.random())
                            .slice(0, 4);

            idx.forEach((i, j) => {
                let letter = String.fromCharCode(97 + j);
                let row = renderSplitRow(letter, d.questions[i], d.answers[i]);
                questionsBox.innerHTML += row.questionHTML;
                answersBox.innerHTML += row.answerHTML;
            });
        });
    }
}
</script>
</body>
</html>